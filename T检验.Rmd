---
title: "T检验"
author: "shydow"
date: "2018年12月15日"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##单样本T检验
单样本T检验实际上是推断该样本来自总体均数μ与已知的某一总体均数μ0（经常是理论值或标准值，即学术规定的）有无差别。  
检验统计量的计算方式：  
            t=X'-μ/（S/sqrt（n）），v=n-1  v为自由度  
X'指待样本的均值，μ指常规样本的均值，S指标准差，n指待测样本的记录数  

例子：  
根据调查显示，健康的成年男子脉搏均数为72次/分，某医生在某山区随机抽查健康成年男子25名，其脉搏均数为74.2次/分，标准差为6.5次/分。根据这个资料，能否认为某山区健康成年男子的脉搏数与一般健康成年男子不同？  

解：  
  （1）提出检验假设H0与备选假设H1
  H0：μ=μ0=72次/分，即山区成年男子的脉搏均数与一般成年男子的相等  
  H1：μ<>μ0=72次/分，即山区成年男子的脉搏均数与一般成年男子不想等（双侧检验）  
  
  （2）定显著性水平α，并查出临界t值，现令α=0.05  
  本例中自由度v=n-1=24，查表得t（0.05，24）=2.064，若观察资料中求出得|t|值小于此数，我们就接受H0,若大于或等于此数，则拒绝H0,接受H1  
  
  （3）计算检验统计量t  
  已知n=25，X'=72.4,S=6.5,μ0=72.0  
          t=(74.2-72)/(6.5/sqrt(25))=1.692,v=25-1=24  
  
  （4）确定p值，做出推断结论  
  因为|t|<t(0.05,24)=2.064,所以我们接受H0，拒绝H1，即不能得出某山区健康成年男子得脉搏数与一般健康成年男子不同而具有显著差别  

###R中实现单样本T检验统计

格式：  
t.test(data$sample1,mu=mu0,conf.level=0.99,paired=FLASE,var.equal=FALSE,alternative=c('two.sides','less','greater'))  

***data***：数据集  
***sample1***：要分析得变量  
***mu=mu0***：用来指定样本所需要进行比较的常数  
***conf.level***：置信度水平  
***var.equal***：指定是否方差齐性  
***alternative***：指定单侧检验还是双侧检验  

例子：  

已知某水样中含碳酸钙的真值为20.7mg/L，现在用某方法重复测定该水样12次，碳酸钙的含量分别是20，99，20.41，20.10，20.00，20.91，22.60，20.99，20.42，20.90，20.99，23.12，20.89，请问该法测定碳酸钙含量的均值与真值有无明显差异？  

步骤：  
计算12次测量结果的均值与标准差，带入T检验公式即可  

```{r}
example7_2<-read.csv('F:\\课件\\资源\\《R语言统计分析与应用》配套程序\\第七章\\example7_2.csv',header=TRUE)
t.test(example7_2$caco3,mu=20.7,alternative = 'two.sided',conf.level = 0.95)

```

以上得出p值为0.1455，>0.05,故该方法测量得到的均值与真值的差异无统计学意义，即可以用该方法测量水中碳酸钙的含量  
```{r}
#无原始数据的单样本t检验
#以山区健康成年男子的脉搏均数为例
u0<-72
u1<-74.2
s<-6.5
n<-25
t<-(u1-u0)/(s/sqrt(n))
v<-n-1
2*pt(-abs(t),v)   #这里是双侧检验，如果单侧不需*2，pt()函数用来计算显著性值
```
以上p值为0.1035，>0.05，故不能得出山区健康男子的脉搏数不同于一般健康男子  


##两独立样本T检验

在日常生活中，我们经常要比较某两组计量资料的均值有无显著差别，比如研究不同方法的效果，两种不同制剂对杀灭老鼠体内寄生虫的效果，假若事先难以找到条件完全一样的动物配对比较，那么不能求出每对的差数，只能计算各组的均数，然后进行比较。  

步骤：  
假定两组相应的总体均数相等，看两组均数实际相差与此假设是否靠近，近似则把相差看成抽样误差表现，远到一定界限则认为由抽验误差造成这样大的相差的可能性实在太小，拒绝假设而接受H1，做出两总体不相等。  

基础理论:  
两样本T检验又称为成组T检验，适用于完全随机设计两样本均数的比较，人们所关心的是两样本均数所代表的两总体均数是否相等。两组完全随机设计，是将受试对象完全随机分配到两个不同的处理组。  
当两样本含量较小，且均来自正态分布总体时，则要根据两总体方差是否不同而采用不同的检验方法。  

（1）总体方差相等的T检验：将两样本方差合并，求两者的共同方差 S2  
     T检验统计量：  
        
            t=[(X1-X2)-(u1-u2)]/S2=[X1-X2]/S2,V=N1+N2-2
 
（2）在R中使用var.test()函数进行方差齐性检验（F检验）  
    格式：  
        var.test(x,y,ratio=1,alternative=c('two.sided','less','greater'),conf.level=0.95,..)  
 ***x,y***用以比较的连续变量  
 ***ratio***两个变量方差假设比值  
 ***conf.level***置信度水平  
 ***alternative***指定单侧检验或双测检验  
 
案例：  
有两组老鼠，分别饲以高蛋白和低蛋白饲料，8周后记录各老鼠体重增加量如下，问两组老鼠的增重的均数差别是否显著？  

高蛋白组：134 146 104 119 124 161 107 83 113 129 97 123  
低蛋白组：70 118 101 85 107 132 94  

```{r}
example7_10<-read.csv('F:\\课件\\资源\\《R语言统计分析与应用》配套程序\\第七章\\example7_10.csv',header=TRUE)
example7_10
attach(example7_10)
x1<-x[group==1]
x2<-x[group==2]
var.test(x1,x2,ratio = 1)  #测试两组数据方差齐性
t.test(x~group,var.equal=TRUE,alternative='two.sided',conf.level=0.95)


```

案例：无原始数据的两独立样本T检验分析实例  

测量某两个地区水中碳酸钙的含量，分别从两个地区随机抽取20份样品进行碳酸钙检测，分别得到两个地区碳酸钙含量的均数和标准差，结果如表7-6所示。试判断两个地区水中碳酸钙的含量是否有差异。  

分组           n          X'         S  
对照组         20         20.95      5.89  
实验组         20         21.79      3.43  

```{r}
x1<-20.95
x2<-21.79
n1<-20
n2<-20
s1<-5.89
s2<-3.43
sc<-sqrt((1/n1+1/n2)*((n1-1)*s1^2+(n2-1)*s2^2)/(n1+n2-2))
t<-(x2-x1)/sc
v<-n1+n2-2
2*pt(-abs(t),v)
```




  
  
  
  
  
  
  
  
  
  



            

